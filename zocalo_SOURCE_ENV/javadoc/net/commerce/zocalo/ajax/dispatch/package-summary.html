<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_24) on Sat Apr 16 21:44:15 PDT 2011 -->
<TITLE>
net.commerce.zocalo.ajax.dispatch (Zocalo Prediction Markets)
</TITLE>

<META NAME="date" CONTENT="2011-04-16">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="net.commerce.zocalo.ajax.dispatch (Zocalo Prediction Markets)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Package</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <FONT CLASS="NavBarFont1">Class</FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../net/commerce/zocalo/package-summary.html"><B>PREV PACKAGE</B></A>&nbsp;
&nbsp;<A HREF="../../../../../net/commerce/zocalo/ajax/events/package-summary.html"><B>NEXT PACKAGE</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?net/commerce/zocalo/ajax/dispatch/package-summary.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="package-summary.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<H2>
Package net.commerce.zocalo.ajax.dispatch
</H2>
This package allows Zocalo to publish significant events via <a href="http://logging.apache.org/log4j">Log4J</a>
and <a href="http://cometdd.org/">cometd</a> (an AJAX technology).
<P>
<B>See:</B>
<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<A HREF="#package_description"><B>Description</B></A>
<P>

<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Class Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/AppenderBase.html" title="class in net.commerce.zocalo.ajax.dispatch">AppenderBase</A></B></TD>
<TD>&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/BidUpdateDispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch">BidUpdateDispatcher</A></B></TD>
<TD>marshal events that represent changes to the active bids displayed in the stripchart.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/Dispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch">Dispatcher</A></B></TD>
<TD>Dispatchers marshall events and publish them via cometd.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/MockBayeux.html" title="class in net.commerce.zocalo.ajax.dispatch">MockBayeux</A></B></TD>
<TD>&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/MockBayeuxChannel.html" title="class in net.commerce.zocalo.ajax.dispatch">MockBayeuxChannel</A></B></TD>
<TD>&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/NewChartAppender.html" title="class in net.commerce.zocalo.ajax.dispatch">NewChartAppender</A></B></TD>
<TD>publishes actions announcing <A HREF="../../../../../net/commerce/zocalo/ajax/events/NewChart.html" title="class in net.commerce.zocalo.ajax.events"><CODE>new price charts</CODE></A> to cometd.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/NewChartDispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch">NewChartDispatcher</A></B></TD>
<TD>marshalls events that announce the availability of
 <A HREF="../../../../../net/commerce/zocalo/ajax/events/NewChart.html" title="class in net.commerce.zocalo.ajax.events"><CODE>new price charts</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/PriceActionAppender.html" title="class in net.commerce.zocalo.ajax.dispatch">PriceActionAppender</A></B></TD>
<TD>publishes actions describing bidding behavior to cometd</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/PriceChangeAppender.html" title="class in net.commerce.zocalo.ajax.dispatch">PriceChangeAppender</A></B></TD>
<TD>publishes actions announcing <A HREF="../../../../../net/commerce/zocalo/ajax/events/PriceChange.html" title="class in net.commerce.zocalo.ajax.events"><CODE>new MarketMaker prices</CODE></A> to cometd.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/PriceChangeDispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch">PriceChangeDispatcher</A></B></TD>
<TD>marshalls events that represent <A HREF="../../../../../net/commerce/zocalo/ajax/events/PriceChange.html" title="class in net.commerce.zocalo.ajax.events"><CODE>new price levels</CODE></A>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/PrivateEventAppender.html" title="class in net.commerce.zocalo.ajax.dispatch">PrivateEventAppender</A></B></TD>
<TD>Uses log4j to dispatch events to individual endpoints
 rather than broadcasting them.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/PrivateEventDispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch">PrivateEventDispatcher</A></B></TD>
<TD>marshalls private events and distributes them to a particular user via comet.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/TradeEventDispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch">TradeEventDispatcher</A></B></TD>
<TD>marshalls events that represent trades that have taken place.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/TransitionAppender.html" title="class in net.commerce.zocalo.ajax.dispatch">TransitionAppender</A></B></TD>
<TD>publishes actions representing Session state transitions to cometd.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD WIDTH="15%"><B><A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/TransitionDispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch">TransitionDispatcher</A></B></TD>
<TD>marshalls events that represent state transitions in the Session.</TD>
</TR>
</TABLE>
&nbsp;

<P>
<A NAME="package_description"><!-- --></A><H2>
Package net.commerce.zocalo.ajax.dispatch Description
</H2>

<P>
This package allows Zocalo to publish significant events via <a href="http://logging.apache.org/log4j">Log4J</a>
and <a href="http://cometdd.org/">cometd</a> (an AJAX technology). The events
(in <A HREF="../../../../../net/commerce/zocalo/ajax/events/package-summary.html"><CODE>events</CODE></A>) are used to add information to the log,
to store records in the database, to update the strip chart showing bidding activity to experimental subjects, and
to notify the UI of significant events.  Log4J provides a general framework for connecting together reports of events
that can be output in a variety of formats and piped dynamically without changing the call site.<p>

There are two hierarchies here: <A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/Dispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch"><CODE>Dispatchers</CODE></A>, and Appenders.  The
Appenders are specializations of Log4J's <CODE>AppenderSkeleton</CODE>.
Dispatchers marshall events and publish them via cometd. <p>

The Log4J framework is used to distribute the actions to cometd, to Zocalo's own Log4J logs, and to produce
records of transactions in the database for the prediction market. The Appenders provide the connection between
Log4J and cometd by registering an interest in particular Log4J channels, and when events arrive, publishing
them to cometd using the Dispatchers.<p>

<A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/PriceActionAppender.html" title="class in net.commerce.zocalo.ajax.dispatch"><CODE>PriceActionAppender</CODE></A> is interested in trades and other changes in prices including new bids
(<A HREF="../../../../../net/commerce/zocalo/ajax/events/Bid.html" title="class in net.commerce.zocalo.ajax.events"><CODE>Bid</CODE></A> and <A HREF="../../../../../net/commerce/zocalo/ajax/events/Ask.html" title="class in net.commerce.zocalo.ajax.events"><CODE>Ask</CODE></A>), retracted bids
(<A HREF="../../../../../net/commerce/zocalo/ajax/events/OrderRemoval.html" title="class in net.commerce.zocalo.ajax.events"><CODE>OrderRemoval</CODE></A> and <A HREF="../../../../../net/commerce/zocalo/ajax/events/SelfDealing.html" title="class in net.commerce.zocalo.ajax.events"><CODE>SelfDealing</CODE></A>), changes in the
best bid and ask (<A HREF="../../../../../net/commerce/zocalo/ajax/events/BestBid.html" title="class in net.commerce.zocalo.ajax.events"><CODE>BestBid</CODE></A>, and
<A HREF="../../../../../net/commerce/zocalo/ajax/events/BestAsk.html" title="class in net.commerce.zocalo.ajax.events"><CODE>BestAsk</CODE></A>), and completed trades (<A HREF="../../../../../net/commerce/zocalo/ajax/events/Trade.html" title="class in net.commerce.zocalo.ajax.events"><CODE>Trade</CODE></A>). The
other Appender is <A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/TransitionAppender.html" title="class in net.commerce.zocalo.ajax.dispatch"><CODE>TransitionAppender</CODE></A>, which is interested in
<A HREF="../../../../../net/commerce/zocalo/ajax/events/Transition.html" title="class in net.commerce.zocalo.ajax.events"><CODE>Transition</CODE></A> actions affecting experiments.<p>

The Dispatchers marshall the events and send them on to cometd.
<A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/TradeEventDispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch"><CODE>TradeEventDispatcher</CODE></A> deals with events representing trades that have taken place,
<A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/BidUpdateDispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch"><CODE>BidUpdateDispatcher</CODE></A> handles events that involve changing the active bids
displayed on the stripchart, and <A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/TransitionDispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch"><CODE>TransitionDispatcher</CODE></A> handles events that
represent state transitions in experiment sessions which have effects in the browser that go beyond the strip chart.<p>

<h2>Event Flow</h2>

<A HREF="../../../../../net/commerce/zocalo/ajax/events/package-summary.html"><CODE>Event</CODE></A>) objects are created when something significant happens in the server.<p>

Events are instances of subclasses of <A HREF="../../../../../net/commerce/zocalo/ajax/events/Action.html" title="class in net.commerce.zocalo.ajax.events"><CODE>Action</CODE></A>, which extends
<CODE>LoggingEvent</CODE>. This makes it possible for them to be handed directly to a
logger which causes them to be passed as an argument to the AppenderSkeleton's
<CODE>append(LoggingEvent)</CODE>. method.<p>

Log4j provides AppenderSkeleton, which is the prototype for Appenders that consume Events.  Zocalo's Appenders format
the events and distribute them to <A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/Dispatcher.html" title="class in net.commerce.zocalo.ajax.dispatch"><CODE>Dispatchers</CODE></A>.  The dispatchers
have a reference to a bayeux channel (<a href='http://cometdproject.dojotoolkit.org/'>Bayeux</a> is a protocol that supports
<a href='http://en.wikipedia.org/wiki/Comet_(programming)'>AJAX</a>-style browser intereactions.)  The dispatchers can
marshall events and thereby publish them to AJAX.  There's also a <A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/MockBayeux.html" title="class in net.commerce.zocalo.ajax.dispatch"><CODE>MockBayeux</CODE></A>
and <A HREF="../../../../../net/commerce/zocalo/ajax/dispatch/MockBayeuxChannel.html" title="class in net.commerce.zocalo.ajax.dispatch"><CODE>MockBayeuxChannel</CODE></A> that allows Zocalo to collect events internally when necessary.<p>

Each Appender has one or more Dispatcher.  The Appenders react to specific server-side events, and distribute them to
their dispatchers.  The dispatchers represent a particular channel distributing messages for a set of clients. This
allows javascript in the browser to specify which set of events it wants to consume and assign a handler method in
the browser to be invoked when a message of interest arrives.<p>

Here are three example cases.  PriceChange events are generated during experiments whenever there's a change is the set
of bids in the book, and are used in the browser to trigger updating the candle chart displaying all the outstanding offers.
(They are distinct from Trades, which only occur when an actual trade takes place, and cause a new historical price to be
displayed, and the candle moved right.)  IndividualTimingEvents are distributed directly to a particular user (a Judge)
when a timer expires.  In the browser, we can then disable the judge's inputbox for entering price estimates.  This only
affects one experiment subject.  The third case is used to update price charts after a trade in a prediction market.
It takes a significant amount of time to compute the price charts, so we have a separate thread generating them, and
once the chart is ready, we send out an update to all the browsers viewing that market so they can request a new copy.
Since this is a simple image refresh, Jetty can handle it in parallel with the continuing market activity.<p>

The table shows the current events and how and where the code sets up the path they traverse.  For each, we show

<ol>
  <li>The use of the event.
  <li>the event object and where it's created
  <li>the Appender that the event gets registered on.  Notice that PriceActionAppender handles only PriceActions, but has two client Dispatchers.
  <li>The Logger used.
  <li>where logger.callAppenders is called to invoke a Dispatcher
  <li>The Dispatcher and where it's created.
  <li>Where the dispatcher filters events by market.  (The same logger
  can be re-used for multiple channels.)
  <li>The Bayeux channel the Dispatcher publishes events to.
  <li>Where the javascript subscribes to the Bayeux channel, and the function invoked to handle each event.
  <li>If the events are also consumed within the server, where the server's subscription appears. (Not listed for Prediction Markets)
  <li>What use is made of the events within the server.   (Not listed for Prediction Markets)
  </ol> 

  There are two tables.  The first shows combinations used in
  Experiments, and the second covers prediction markets.

<table border=1 cellpadding=4 cellspacing=0 width="95%" >
 <tr >
  <th >EXPERIMENTS</th>
  <th >Book Price update  (Exp)</td>
  <th >Timing Events (Exp)</td>
  <th >Trade Events   (Exp)</td>
  <th >Transition Events (Exp)</td>
 </tr>
 <tr >
  <th >Purpose</td>
  <td >Book Price update: modify candle and current bids and asks</td>
  <td >Judge timed out</td>
  <td >Trade took place: add a black dot</td>
  <td >Experiment transitioned to the next phase </td>
 </tr>
 <tr >
  <th >Event</td>
  <td >PriceAction created in recordTrade in
  BinaryMarketMaker or MultiMarketMaker after trade</td>
  <td >created in TimerTask in Judge.getCutoffTimer()</td>
  <td >PriceAction created in Binary, Unary, and
  MultiMarket, in record*Trade()</td>
  <td >Transition is created in Session.logTransitionEvent()</td>
 </tr>
 <tr >
  <th >Appender</td>
  <td ><b>PriceActionAppender</b> created in
  Session.initializeMarket() for bayeux and MockBayeux.</td>
  <td ><b>PrivateEventAppender</b> created in
  Session.initializeMarket().</td>
  <td ><b>PriceActionAppender</b> created in
  Session.initializeMarket() for bayeux and MockBayeux.</td>
  <td ><b>TransitionAppender</b> created in
  Session.initializeTransitionAppender().</td>
 </tr>
 <tr >
  <th >Logger</td>
  <td >PriceAction.class</td>
  <td >IndividualTimingEvent.class</td>
  <td >PriceAction.class</td>
  <td >Transition.class</td>
 </tr>
 <tr >
  <th >callAppenders()</td>
  <td >PriceAction.log() called in event constructor, which uses Logger(PriceAction.class)</td>
  <td >in IndividualTimingEvent constructor logger.callAppenders(this);</td>
  <td >PriceAction.log() called in event constructor, which uses Logger(PriceAction.class)</td>
  <td >in Transition constructor</td>
 </tr>
 <tr >
  <th >Dispatcher</td>
  <td >BidUpdateDispatcher created by PriceActionAppender</td>
  <td >PrivateEventDispatcher created by PrivateEventAppender.  PrivateEventDispatcher uses deliver() to send the message to just one client.</td>
  <td >PriceActionAppender creates a TradeEventDispatcher</td>
  <td >TransitionDispatcher created by TransitionAppender</td>
 </tr>
 <tr >
  <th >Bayeux channel</b></td>
  <td >/<b>liveUpdate</b></td>
  <td >/service/<b>privateEvent</b></td>
  <td >/<b>historicalUpdate</b></td>
  <td >/<b>transition</b></td>
 </tr>
 <tr >
  <th >javascript subscription</td>
  <td >stripchartframe.html has onload_actions() (called from onload) that calls dojox.cometd.subscribe( &quot;/liveUpdate&quot;, onLiveMessage);</td>
  <td >JudgeSubFrame.jsp has onload_actions() (called from onload) that calls
  dojox.cometd.subscribe( &quot;/service/privateEvent&quot;,onPrivateMessage);</td>
  <td >stripchartframe.html has onload_actions() (called from onload) that calls
  dojox.cometd.subscribe( &quot;/historicalUpdate&quot;,onHistMessage);</td>
  <td >stripchartframe.html has onload_actions() (called from onload) that calls dojox.cometd.subscribe( "/transition", onTransitionMessage); </td>
 </tr>
 <tr >
  <th >Server Subscription</td>
  <td >NONE</td>
  <td >ExperimentServer. ExperimentBayeuxServer constructor
  calls subscribe( PrivateEventDispatcher. PRIVATE_EVENT_TOPIC_SUFFIX,
  &quot;sendPrivateUpdate&quot;)</td>
  <td >Session.initializeMarket() calls        
  tradeHistory = (<b>MockBayeuxChannel</b>)
  sessionHistory.getChannel( TradeEventDispatcher. TRADE_EVENT_TOPIC_SUFFIX,
  true);</td>
  <td >NONE</td>
 </tr>
 <tr >
  <th >Server Client</td>
  <td >NONE</td>
  <td >redirect to specific client</td>
  <td >private MockBayeuxChannel tradeHistory;</td>
  <td >NONE</td>
 </tr>
</table>

<p>

<table border=1 cellpadding=4 cellspacing=0 width="95%" >
 <tr >
  <th >PREDICTION MARKETS</th>
  <th >MM Price Update (PM)</td>
  <th >New Charts  (PM)</td>
  <th >Transition Events   (PM)</td>
 </tr>
 <tr >
  <th >Purpose</td>
  <td >Market Maker price update: update prices in table</td>
  <td >new price chart is ready: refresh</td>
  <td >A new Market opened, give Users a link</td>
 </tr>
 <tr >
  <th >Event</td>
  <td >PriceChange created in recordTrade in BinaryMarketMaker or MultiMarketMaker after trade  </td>
  <td >created in ChartGenerator updateChartFile() and  writeMultiStepChartFile()</td>
  <td >Transition is created in MarketOwner.newBinaryMarket() or MarketOwner.newMultiMarket()</td>
 </tr>
 <tr >
  <th >Appender</td>
  <td ><b>PriceChangeAppender</b> created in
  AllMarkets.MarketBayeuxService (bayeux, marketName). </td>
  <td ><b>NewChartAppender</b> created in
  AllMarkets.MarketBayeuxService (bayeux, marketName).</td>
  <td ><b>TransitionAppender</b> created in
  MarketBayeuxService constructor().</td>
 </tr>
 <tr >
  <th >Logger</td>
  <td >PriceChange.class</td>
  <td >NewChart.class</td>
  <td >Transition.class</td>
 </tr>
 <tr >
  <th >callAppenders()</td>
  <td >in PriceChange constructor, calls
  Logger(PriceChange.class) .callAppenders(this)</td>
  <td >NewChart constructor </td>
  <td >Transition constructors</td>
 </tr>
 <tr >
  <th >Dispatcher</td>
  <td >PriceChangeDispatcher created in PriceChangeAppender
  constructor</td>
  <td >NewChartDispatcher created by NewChartAppender</td>
  <td >TransitionDispatcher created by TransitionAppender</td>
 </tr>
 <tr >
  <th >Filtering</td>
  <td >PriceChangeDispatcher.publishTransition()</td>
  <td >NewChartDispatcher.publishTransition()</td>
  <td >NA</td>
 </tr>
 <tr >
  <th >Bayeux channel</b></td>
  <td >Dispatcher.buildChannelName() produces /<b>priceChange</b>/ + marketName</td>
  <td >Dispatcher.buildChannelName() produces /<b>newChart</b>/ + marketName</td>
  <td >/<b>transition</b></td>
 </tr>
 <tr >
  <th >javascript subscription</td>
  <td >channels.push(
  dojox.cometd.subscribe( priceUpdateChannel, onPriceUpdate));</td>
  <td >purchaseCost.jsp has onload_actions() (called from
  onload) that calls
  dojox.cometd.subscribe( /newChart/+claimName, onPriceUpdate);</td>
  <td >purchaseClaim.jsp and purchaseCost.jsp have onload_actions() (called from onload) that call
 dojox.cometd.subscribe( "/transition", onTransitionMessage); </td>
 </tr>
 <tr >
</table>

<p>


<br><table border=1 align=center> <tr><td valign=middle>
&copy; Copyright 2007-2009 Chris Hibbert.  All rights reserved.<br>
&copy; 2006 CommerceNet Consortium, LLC.  
<p>
This software is published under the terms of the MIT license, a copy <br>
of which has been included with this distribution in the LICENSE file.
</td> </tr></table>
<br>
<P>

<P>
<DL>
</DL>
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Package</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <FONT CLASS="NavBarFont1">Class</FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../net/commerce/zocalo/package-summary.html"><B>PREV PACKAGE</B></A>&nbsp;
&nbsp;<A HREF="../../../../../net/commerce/zocalo/ajax/events/package-summary.html"><B>NEXT PACKAGE</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?net/commerce/zocalo/ajax/dispatch/package-summary.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="package-summary.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
