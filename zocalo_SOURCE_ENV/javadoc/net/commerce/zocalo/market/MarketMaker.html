<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_24) on Sat Apr 16 21:44:15 PDT 2011 -->
<TITLE>
MarketMaker (Zocalo Prediction Markets)
</TITLE>

<META NAME="date" CONTENT="2011-04-16">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="MarketMaker (Zocalo Prediction Markets)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../net/commerce/zocalo/market/MarketCallback.html" title="class in net.commerce.zocalo.market"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../net/commerce/zocalo/market/MultiMarket.html" title="class in net.commerce.zocalo.market"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?net/commerce/zocalo/market/MarketMaker.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="MarketMaker.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
net.commerce.zocalo.market</FONT>
<BR>
Class MarketMaker</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by "><B>net.commerce.zocalo.market.MarketMaker</B>
</PRE>
<DL>
<DT><B>Direct Known Subclasses:</B> <DD><A HREF="../../../../net/commerce/zocalo/market/BinaryMarketMaker.html" title="class in net.commerce.zocalo.market">BinaryMarketMaker</A>, <A HREF="../../../../net/commerce/zocalo/market/MultiMarketMaker.html" title="class in net.commerce.zocalo.market">MultiMarketMaker</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public abstract class <B>MarketMaker</B><DT>extends java.lang.Object</DL>
</PRE>

<P>
A MarketMaker offers to buy and sell coupons for a particular claim.
     See Robin Hanson's paper on <a href="http://hanson.gmu.edu/mktscore.pdf">Scoring
    Rules</a> for details.   The price is
    determined by the history of past sales.  Each time the MarketMaker (sometimes
    referred to as AMM) sells, the price increases, each time it buys, the price
    decreases.  This MarketMaker uses an exponential rule to determine how much to change
    the price.<p>

    The market maker follows an exponential rule based on its current price, which means
    that when its current price (p) is changing to newP, the user pays log(newP/p) coupons
    on one side to get log((1 - newP) / (1 - p)) coupons on the other side.  After each such
    transaction, the marketMaker moves the probability to newP.  Notice that this is
    expressed in terms of trading coupons for coupons.<p>

    Since the user thinks in terms of paying money for coupons, we need to translate.  The
    user uses |log((1 - newP) / (1 - p))| [which we call baseC] (times the cost of a coupon)
    in funds to buy baseC
    sets of coupons, and then trades those coupons on one side for |log(newProb/prob)|
    [which we call incrC] coupons on the other side.  The net effect is that the user is
    down by baseC (* couponCost) in funds, and up by |incrC - baseC| [which we call totalC]
    coupons.  The
    transaction actually happens by having the marketMaker accept the funds, buy the coupons,
    and make the trade.  Notice that baseC and incrC have opposite signs appropriately
    reflecting the user's costs and gains, but we always transfer positive quantities.<p>

    We use this new terminology because the ratios apply to different steps for different
    transactions.  The user may be buying or selling a single position.  (In the binary
    case these are symmetrical, but not in the multi-outome case.)  Complementary coupons
    (complementary sets in the multi-outcome case) can be used in the purchase instead of
    cash.  I use "C" in these names because it's short, and it evokes "cost", "coupons",
    and "cash".  None of these would be right, since each name sometimes refers to cost
    and other times to gain, and each applies to cash and coupons in different
    transactions.<p>

    The simplest case is the user providing funds in exchange for coupons.  The user
    spends baseC in funds, and receives totalC in coupons (the AMM adds incrC in funds to
    the user's baseC to buy totalC sets from the bank, and keeps the unwanted coupons in
    its account.)  The next simplest case is selling a position when the user already has
    sufficient coupons.  The user provides totalC coupons and receives baseC in funds,
    which the AMM gets by combining the user's coupons with its own and turning them in
    to the bank for cash, of which it keeps incrC.  If the user wants to sell and doesn't
    have coupons, it costs incrC, which earns totalC in complementary assets.  In this
    case, the AMM contributes baseC in funds.  So the ratios apply differently in buying
    and selling and sometimes refer to the user's contribution and sometimes the AMM's.<p>

    Traders can specify the size of a trade in terms of the target probability (or
    equivalently price), the maximum number of shares, or the maximum cost (a maximum cost
    is also imposed by the trader's budget.)  We have to be able to compute newP from any
    of these choices, and find the most restrictive limit.  We sometimes need to compute
    newP from incrC, baseC, or totalC.<p>

    Another item worth clarifying about the explanation above: I spoke in terms of "sets".
    For binary markets I would have said "pairs", which would have been reasonably clear.
    In the multi-outome case, the arithmetic works out that the user can specify any subset
    of the outcomes, and everything works out.  If a claim has 5 possible outcomes (a, b,
    c, d, and e) and the user wants to buy a and c in preference to b, d, and e, then you
    add the probabilities for a and c to find p (the others add up to [1-p]) and follow
    the same procedure.  The user pays baseC for baseC sets (which means baseC of each
    outcome), and then trades the baseC coupons of b, d, and e for incrC coupons of a and
    incrC of c.  The user is out baseC in funds, and now has totalC of a and totalC of c.
    The market maker has spent incrC in funds and has totalC of b, d, and e.  The bank has
    collected totalC in funds and issued totalC complete sets.  The code currently only
    supports specifying one outcome to purchase, but that's mostly because the UI issues
    for specifying other combinations are complicated.<p>
<P>

<P>
<HR>

<P>
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;double</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#EPSILON">EPSILON</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#MarketMaker(net.commerce.zocalo.market.Market, net.commerce.zocalo.currency.Quantity, net.commerce.zocalo.user.User)">MarketMaker</A></B>(<A HREF="../../../../net/commerce/zocalo/market/Market.html" title="class in net.commerce.zocalo.market">Market</A>&nbsp;market,
            <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A>&nbsp;subsidy,
            <A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;owner)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#addAllCoupons(java.util.Set, net.commerce.zocalo.user.User)">addAllCoupons</A></B>(java.util.Set&nbsp;couponsSet,
              <A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;user)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#baseC(net.commerce.zocalo.claim.Position, net.commerce.zocalo.currency.Probability)">baseC</A></B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position,
      <A HREF="../../../../net/commerce/zocalo/currency/Probability.html" title="class in net.commerce.zocalo.currency">Probability</A>&nbsp;targetProbability)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The money price charged to move the probability from p to newP is |B * log((1 - newP)/(1 - p)| * couponCost</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#buyOrSellUpToQuantity(net.commerce.zocalo.claim.Position, net.commerce.zocalo.currency.Price, net.commerce.zocalo.currency.Quantity, net.commerce.zocalo.user.User)">buyOrSellUpToQuantity</A></B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position,
                      <A HREF="../../../../net/commerce/zocalo/currency/Price.html" title="class in net.commerce.zocalo.currency">Price</A>&nbsp;price,
                      <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A>&nbsp;quantity,
                      <A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;user)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#buyUpToQuantity(net.commerce.zocalo.claim.Position, net.commerce.zocalo.currency.Probability, net.commerce.zocalo.currency.Quantity, net.commerce.zocalo.user.User)">buyUpToQuantity</A></B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position,
                <A HREF="../../../../net/commerce/zocalo/currency/Probability.html" title="class in net.commerce.zocalo.currency">Probability</A>&nbsp;targetProbability,
                <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A>&nbsp;maxQuantity,
                <A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;user)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;buy from the marketMaker to make the probability reach TARGETPROBABILITY,
        and up to MAXQUANTITY total coupons, whichever is less.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#buyWithCostLimit(net.commerce.zocalo.claim.Position, net.commerce.zocalo.currency.Probability, net.commerce.zocalo.currency.Quantity, net.commerce.zocalo.user.User)">buyWithCostLimit</A></B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position,
                 <A HREF="../../../../net/commerce/zocalo/currency/Probability.html" title="class in net.commerce.zocalo.currency">Probability</A>&nbsp;targetProbability,
                 <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A>&nbsp;costLimit,
                 <A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;user)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;purchase from the marketMaker up to a probability of TARGETPROBABILITY,
        and up to COSTLIMIT total funds, whichever is less.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>abstract &nbsp;<A HREF="../../../../net/commerce/zocalo/currency/Probability.html" title="class in net.commerce.zocalo.currency">Probability</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#currentProbability(net.commerce.zocalo.claim.Position)">currentProbability</A></B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#getBeta()">getBeta</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>Deprecated.</B>&nbsp;<I></I>&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../net/commerce/zocalo/currency/Price.html" title="class in net.commerce.zocalo.currency">Price</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#maxPrice()">maxPrice</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../net/commerce/zocalo/currency/Accounts.html" title="class in net.commerce.zocalo.currency">Accounts</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#redeem(net.commerce.zocalo.currency.CouponBank)">redeem</A></B>(<A HREF="../../../../net/commerce/zocalo/currency/CouponBank.html" title="class in net.commerce.zocalo.currency">CouponBank</A>&nbsp;couponBank)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return my accounts only if the requestor knows my market's couponBank.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#roundedPriceEqualsRoundedProb(net.commerce.zocalo.claim.Position, net.commerce.zocalo.currency.Price, java.math.MathContext)">roundedPriceEqualsRoundedProb</A></B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position,
                              <A HREF="../../../../net/commerce/zocalo/currency/Price.html" title="class in net.commerce.zocalo.currency">Price</A>&nbsp;price,
                              java.math.MathContext&nbsp;context)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#sellHoldings(net.commerce.zocalo.user.User, net.commerce.zocalo.claim.Position)">sellHoldings</A></B>(<A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;user,
             <A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;pos)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../net/commerce/zocalo/market/MarketMaker.html#setBeta(net.commerce.zocalo.currency.Quantity)">setBeta</A></B>(<A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A>&nbsp;beta)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>Deprecated.</B>&nbsp;<I></I>&nbsp;</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="EPSILON"><!-- --></A><H3>
EPSILON</H3>
<PRE>
public static final double <B>EPSILON</B></PRE>
<DL>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../../constant-values.html#net.commerce.zocalo.market.MarketMaker.EPSILON">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="MarketMaker(net.commerce.zocalo.market.Market, net.commerce.zocalo.currency.Quantity, net.commerce.zocalo.user.User)"><!-- --></A><H3>
MarketMaker</H3>
<PRE>
public <B>MarketMaker</B>(<A HREF="../../../../net/commerce/zocalo/market/Market.html" title="class in net.commerce.zocalo.market">Market</A>&nbsp;market,
                   <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A>&nbsp;subsidy,
                   <A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;owner)</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="roundedPriceEqualsRoundedProb(net.commerce.zocalo.claim.Position, net.commerce.zocalo.currency.Price, java.math.MathContext)"><!-- --></A><H3>
roundedPriceEqualsRoundedProb</H3>
<PRE>
public boolean <B>roundedPriceEqualsRoundedProb</B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position,
                                             <A HREF="../../../../net/commerce/zocalo/currency/Price.html" title="class in net.commerce.zocalo.currency">Price</A>&nbsp;price,
                                             java.math.MathContext&nbsp;context)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="currentProbability(net.commerce.zocalo.claim.Position)"><!-- --></A><H3>
currentProbability</H3>
<PRE>
public abstract <A HREF="../../../../net/commerce/zocalo/currency/Probability.html" title="class in net.commerce.zocalo.currency">Probability</A> <B>currentProbability</B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="buyWithCostLimit(net.commerce.zocalo.claim.Position, net.commerce.zocalo.currency.Probability, net.commerce.zocalo.currency.Quantity, net.commerce.zocalo.user.User)"><!-- --></A><H3>
buyWithCostLimit</H3>
<PRE>
public <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A> <B>buyWithCostLimit</B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position,
                                 <A HREF="../../../../net/commerce/zocalo/currency/Probability.html" title="class in net.commerce.zocalo.currency">Probability</A>&nbsp;targetProbability,
                                 <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A>&nbsp;costLimit,
                                 <A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;user)</PRE>
<DL>
<DD>purchase from the marketMaker up to a probability of TARGETPROBABILITY,
        and up to COSTLIMIT total funds, whichever is less.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="buyOrSellUpToQuantity(net.commerce.zocalo.claim.Position, net.commerce.zocalo.currency.Price, net.commerce.zocalo.currency.Quantity, net.commerce.zocalo.user.User)"><!-- --></A><H3>
buyOrSellUpToQuantity</H3>
<PRE>
public <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A> <B>buyOrSellUpToQuantity</B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position,
                                      <A HREF="../../../../net/commerce/zocalo/currency/Price.html" title="class in net.commerce.zocalo.currency">Price</A>&nbsp;price,
                                      <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A>&nbsp;quantity,
                                      <A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;user)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="buyUpToQuantity(net.commerce.zocalo.claim.Position, net.commerce.zocalo.currency.Probability, net.commerce.zocalo.currency.Quantity, net.commerce.zocalo.user.User)"><!-- --></A><H3>
buyUpToQuantity</H3>
<PRE>
public <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A> <B>buyUpToQuantity</B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position,
                                <A HREF="../../../../net/commerce/zocalo/currency/Probability.html" title="class in net.commerce.zocalo.currency">Probability</A>&nbsp;targetProbability,
                                <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A>&nbsp;maxQuantity,
                                <A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;user)</PRE>
<DL>
<DD>buy from the marketMaker to make the probability reach TARGETPROBABILITY,
        and up to MAXQUANTITY total coupons, whichever is less.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="sellHoldings(net.commerce.zocalo.user.User, net.commerce.zocalo.claim.Position)"><!-- --></A><H3>
sellHoldings</H3>
<PRE>
public <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A> <B>sellHoldings</B>(<A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;user,
                             <A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;pos)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="addAllCoupons(java.util.Set, net.commerce.zocalo.user.User)"><!-- --></A><H3>
addAllCoupons</H3>
<PRE>
public void <B>addAllCoupons</B>(java.util.Set&nbsp;couponsSet,
                          <A HREF="../../../../net/commerce/zocalo/user/User.html" title="class in net.commerce.zocalo.user">User</A>&nbsp;user)</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="baseC(net.commerce.zocalo.claim.Position, net.commerce.zocalo.currency.Probability)"><!-- --></A><H3>
baseC</H3>
<PRE>
protected <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A> <B>baseC</B>(<A HREF="../../../../net/commerce/zocalo/claim/Position.html" title="class in net.commerce.zocalo.claim">Position</A>&nbsp;position,
                         <A HREF="../../../../net/commerce/zocalo/currency/Probability.html" title="class in net.commerce.zocalo.currency">Probability</A>&nbsp;targetProbability)</PRE>
<DL>
<DD>The money price charged to move the probability from p to newP is |B * log((1 - newP)/(1 - p)| * couponCost
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="redeem(net.commerce.zocalo.currency.CouponBank)"><!-- --></A><H3>
redeem</H3>
<PRE>
public <A HREF="../../../../net/commerce/zocalo/currency/Accounts.html" title="class in net.commerce.zocalo.currency">Accounts</A> <B>redeem</B>(<A HREF="../../../../net/commerce/zocalo/currency/CouponBank.html" title="class in net.commerce.zocalo.currency">CouponBank</A>&nbsp;couponBank)</PRE>
<DL>
<DD>return my accounts only if the requestor knows my market's couponBank.  Since Market doesn't
        hand out its couponBank, it's someone with access to the market's closely-held secrets.
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="getBeta()"><!-- --></A><H3>
getBeta</H3>
<PRE>
public <A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A> <B>getBeta</B>()</PRE>
<DL>
<DD><B>Deprecated.</B>&nbsp;<I></I>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="setBeta(net.commerce.zocalo.currency.Quantity)"><!-- --></A><H3>
setBeta</H3>
<PRE>
public void <B>setBeta</B>(<A HREF="../../../../net/commerce/zocalo/currency/Quantity.html" title="class in net.commerce.zocalo.currency">Quantity</A>&nbsp;beta)</PRE>
<DL>
<DD><B>Deprecated.</B>&nbsp;<I></I>
<P>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="maxPrice()"><!-- --></A><H3>
maxPrice</H3>
<PRE>
public <A HREF="../../../../net/commerce/zocalo/currency/Price.html" title="class in net.commerce.zocalo.currency">Price</A> <B>maxPrice</B>()</PRE>
<DL>
<DD><DL>
</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../net/commerce/zocalo/market/MarketCallback.html" title="class in net.commerce.zocalo.market"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../net/commerce/zocalo/market/MultiMarket.html" title="class in net.commerce.zocalo.market"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html?net/commerce/zocalo/market/MarketMaker.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="MarketMaker.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
